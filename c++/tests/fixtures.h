// Fixtures for the tests

#pragma once

#include <array>
#include <vector>

// For testing automatic differentiation
constexpr std::array fix_d {
    6.1360420701563498,  2.9606444748278875,  9.9253736972586246,
    0.5356792380861322,  -1.4727205961479033, 4.2512661200877879,
    -2.9410316453781444, 3.4797551257539538,  2.8312317178378699,
    -1.4900798993157309, -9.7526376845644123, -8.8824179995985126,
    6.7638244484618752,  -7.1130268493509963, -4.5835128246417494,
    -8.9059115759599745, 32.898784649467867,  218.75264606693996,
    7.5767671483267520,  9.7405995203640394
};

// For testing the LM-solver

constexpr std::array x_data_1 {
    1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0,  10.0, 11.0, 12.0,
    13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0,
    25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0,
    37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0,
    49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0,
    61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0,
    73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0,
    85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 96.0,
    97.0, 98.0, 99.0, 100.0
};

constexpr std::array y_data_1 {
    56.0, 51.0, 54.0, 46.0, 50.0, 48.0, 31.0, 45.0, 37.0, 39.0, 50.0, 30.0,
    27.0, 39.0, 27.0, 29.0, 33.0, 40.0, 36.0, 26.0, 24.0, 23.0, 27.0, 28.0,
    22.0, 30.0, 28.0, 26.0, 23.0, 16.0, 22.0, 20.0, 16.0, 11.0, 19.0, 16.0,
    15.0, 20.0, 19.0, 16.0, 12.0, 16.0, 13.0, 20.0, 23.0, 15.0, 18.0, 10.0,
    15.0, 14.0, 19.0, 15.0, 20.0, 12.0, 12.0, 10.0, 22.0, 9.0,  23.0, 10.0,
    9.0,  13.0, 16.0, 13.0, 6.0,  4.0,  20.0, 12.0, 13.0, 16.0, 10.0, 13.0,
    9.0,  15.0, 4.0,  8.0,  13.0, 7.0,  14.0, 16.0, 12.0, 11.0, 10.0, 7.0,
    12.0, 12.0, 11.0, 14.0, 10.0, 10.0, 10.0, 10.0, 9.0,  11.0, 12.0, 12.0,
    11.0, 11.0, 9.0,  12.0
};

constexpr std::array x_data_2 {
    1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0,  10.0, 11.0, 12.0,
    13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0,
    25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0,
    37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0,
    49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0,
    61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0,
    73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0,
    85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 96.0,
    97.0, 98.0, 99.0, 100.0
};

constexpr std::array y_data_2 {
    153.0, 157.0, 137.0, 111.0, 126.0, 108.0, 113.0, 128.0, 94.0, 93.0,
    112.0, 74.0,  85.0,  83.0,  81.0,  82.0,  88.0,  71.0,  74.0, 76.0,
    68.0,  69.0,  50.0,  50.0,  48.0,  34.0,  44.0,  40.0,  52.0, 33.0,
    41.0,  28.0,  43.0,  33.0,  28.0,  31.0,  33.0,  29.0,  28.0, 32.0,
    32.0,  37.0,  27.0,  23.0,  23.0,  19.0,  15.0,  19.0,  13.0, 21.0,
    16.0,  20.0,  22.0,  17.0,  9.0,   11.0,  16.0,  19.0,  9.0,  17.0,
    9.0,   19.0,  13.0,  9.0,   13.0,  12.0,  16.0,  16.0,  11.0, 9.0,
    8.0,   8.0,   10.0,  5.0,   13.0,  11.0,  9.0,   11.0,  7.0,  13.0,
    6.0,   11.0,  11.0,  10.0,  12.0,  11.0,  11.0,  7.0,   5.0,  9.0,
    11.0,  7.0,   6.0,   8.0,   8.0,   7.0,   5.0,   2.0,   9.0,  5.0
};

// For testing numerical integration

constexpr std::array x_data_single {
    0.6666667e-1, 0.1333333, 0.2000000, 0.2666667, 0.3333333, 0.4000000,
    0.4666667,    0.5333334, 0.6000000, 0.6666667, 0.7333333, 0.8000000,
    0.8666667,    0.9333333, 1.000000,  1.066667,  1.133333,  1.200000,
    1.266667,     1.333333,  1.400000,  1.466667,  1.533333,  1.600000,
    1.666667,     1.733333,  1.800000,  1.866667,  1.933333,  2.000000,
    2.066667,     2.133333,  2.200000,  2.266667,  2.333333,  2.400000,
    2.466667,     2.533333,  2.600000,  2.666667,  2.733333,  2.800000,
    2.866667,     2.933333,  3.000000,  3.066667,  3.133333,  3.200000,
    3.266667,     3.333333,  3.400000,  3.466667,  3.533333,  3.600000,
    3.666667,     3.733333,  3.800000,  3.866667,  3.933333,  4.000000,
    4.066667,     4.133333,  4.200000,  4.266667,  4.333333,  4.400000,
    4.466667,     4.533333,  4.600000,  4.666667,  4.733333,  4.800000,
    4.866667,     4.933333,  5.000000,  5.066667,  5.133333,  5.200000,
    5.266667,     5.333333,  5.400000,  5.466667,  5.533333,  5.600000,
    5.666667,     5.733333,  5.800000,  5.866667,  5.933333,  6.000000,
    6.066667,     6.133333,  6.200000,  6.266667,  6.333333,  6.400000,
    6.466667,     6.533333,  6.600000,  6.666667,  6.733333,  6.800000,
    6.866667,     6.933333,  7.000000,  7.066667,  7.133333,  7.200000,
    7.266667,     7.333333,  7.400000,  7.466667,  7.533333,  7.600000,
    7.666667,     7.733333,  7.800000,  7.866667,  7.933333,  8.000000,
    8.066667,     8.133333,  8.200000,  8.266666,  8.333333,  8.400000,
    8.466666,     8.533334,  8.600000,  8.666667,  8.733334,  8.800000,
    8.866667,     8.933333,  9.000000,  9.066667,  9.133333,  9.200000,
    9.266666,     9.333333,  9.400000,  9.466666,  9.533334,  9.600000,
    9.666667,     9.733334,  9.800000,  9.866667,  9.933333,  10.00000
};

constexpr std::array y_data_single {
    0.7446424775187619e-3, 0.3020901969274037, 2.118368838296920,
    3.150661866261145,     3.443172655439615,  0.7550026371238160,
    1.941128630100767,     1.592520874706278,  1.194772391549097,
    2.967402375714324,     0.7853932604123788, 2.557420971496174,
    2.775901185714637,     3.732225191550757,  3.150242591529852,
    3.068880131585874,     4.565367697007385,  5.219338417269205,
    4.537935029775535,     5.659270052253377,  3.616140658564361,
    4.387665711996727,     6.384733638129235,  5.881447535223184,
    7.129812709102541,     7.736823369600105,  5.362909141895348,
    8.221614308887975,     8.841427706019843,  7.161163403876186,
    9.888474027384003,     8.556487800031528,  8.691567598179841,
    9.932984637438057,     10.04489937050779,  11.96528559774363,
    12.16222796454993,     12.21235316452512,  12.94487278160562,
    11.76898770064314,     14.14900562282943,  14.10684159399991,
    15.27299205856185,     16.71389290538195,  16.06244837890148,
    17.62589367228407,     15.75191604351007,  16.75014592246786,
    17.43523533113402,     19.95337790516898,  18.08011514475433,
    18.97888625961699,     21.05361308952146,  21.46544925688303,
    22.56092196794976,     21.59861678459169,  22.55128393871379,
    22.96325174583868,     25.19768940211313,  25.97376325955071,
    24.99295662584766,     24.00763027563402,  26.32715759774486,
    25.49025420783624,     26.33678770791364,  25.41871769787161,
    26.00016602613493,     26.54456368401887,  27.85119560066156,
    26.79365395091502,     28.77272176067222,  28.97612969631116,
    29.68584135737057,     30.32499631258463,  28.58622313065767,
    28.77397213978151,     31.72395111319326,  30.43069287351143,
    29.97966674134851,     30.12422483262391,  33.12270041028560,
    33.44712980353331,     30.57769096202277,  33.41804169457563,
    32.72928458153292,     33.07663383464768,  33.03312783683992,
    33.09357146345030,     31.70874621197922,  32.20880918976749,
    34.24024897282668,     33.63968888707838,  34.81507521943067,
    32.73360545956249,     32.57455186937932,  32.92121529314402,
    33.44860373282360,     32.47813450580388,  34.48631126759456,
    34.50247087863320,     32.79198104279779,  32.94468531781243,
    32.78294314227252,     35.84563816152474,  34.46566752741064,
    32.76777521820208,     34.58540335005622,  35.27198022234418,
    34.43078014594715,     34.39704479977270,  32.82354242938561,
    33.60496689809176,     33.57339404696947,  34.87554465795731,
    33.29952824299462,     35.03283231907996,  33.53049090966883,
    35.39463975020770,     33.82093682765924,  35.30709423282807,
    33.13808093494541,     33.61265156287722,  34.29581979230704,
    35.65512818522641,     34.41039016957124,  35.92863358464916,
    35.02073308025297,     35.69084343911532,  35.48493562779642,
    34.18279983688602,     35.97042725973928,  34.93912306724490,
    35.81050202266695,     33.59899648461168,  35.13437335515356,
    35.86271175904280,     36.42456066934434,  36.28717152576552,
    35.83806435634538,     35.87749892821460,  35.10100884081518,
    33.13317389327317,     33.63675443955220,  34.88788185815513,
    35.76824608838236,     34.13921996184701,  35.21052889646148,
    35.06589571810614,     36.07175350023468,  34.87199305222757
};

constexpr std::array x_data_double {
    1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0,  10.0, 11.0, 12.0,
    13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0,
    25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0,
    37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0,
    49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0,
    61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0,
    73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, 81.0, 82.0, 83.0, 84.0,
    85.0, 86.0, 87.0, 88.0, 89.0, 90.0, 91.0, 92.0, 93.0, 94.0, 95.0, 96.0,
    97.0, 98.0, 99.0, 100.0
};

constexpr std::array y_data_double {
    3.6478032019380899, 2.8740291222551266, 2.4837940134784784,
    2.2409808901970232, 2.0730319253014420, 1.9490129930586699,
    1.8532155611159311, 1.7767253665611722, 1.7140748532440477,
    1.6617104336131501, 1.6172157791437392, 1.5788870265249628,
    1.5454861390265726, 1.5160906095215569, 1.4899981242227842,
    1.4666640034471516, 1.4456589383388709, 1.4266397079317334,
    1.4093284347496027, 1.3934975977854389, 1.3789590137632568,
    1.3655556077373809, 1.3531551792011309, 1.3416456187431507,
    1.3309311944589812, 1.3209296379330280, 1.3115698348849256,
    1.3027899784443420, 1.2945360799273089, 1.2867607585061775,
    1.2794222504159636, 1.2724835924071065, 1.2659119445351510,
    1.2596780252057607, 1.2537556372031491, 1.2481212680322271,
    1.2427537512469917, 1.2376339780840373, 1.2327446509218629,
    1.2280700715741368, 1.2235959587978449, 1.2193092903813425,
    1.2151981660854523, 1.2112516881209117, 1.2074598567811601,
    1.2038134788875023, 1.2003040873034367, 1.1969238699406859,
    1.1936656070095510, 1.1905226153841550, 1.1874886991587890,
    1.1845581056506878, 1.1817254860293376, 1.1789858601813670,
    1.1763345851642020, 1.1737673268727691, 1.1712800345156544,
    1.1688689176840033, 1.1665304254695796, 1.1642612277156663,
    1.1620581979558615, 1.1599183979148522, 1.1578390634365694,
    1.1558175916404876, 1.1538515292219307, 1.1519385617789106,
    1.1500765039781009, 1.1482632906528560, 1.1464969685262669,
    1.1447756887044001, 1.1430976997018434, 1.1414613410638299,
    1.1398650374694144, 1.1383072932880065, 1.1367866875759496,
    1.1353018694003216, 1.1338515535570795, 1.1324345165801664,
    1.1310495930438531, 1.1296956721293629, 1.1283716944339197,
    1.1270766489959405, 1.1258095705563853, 1.1245695369464095,
    1.1233556667092433, 1.1221671168520579, 1.1210030807512379,
    1.1198627861939252, 1.1187454935455681, 1.1176504940340628,
    1.1165771081418916, 1.1155246840983717, 1.1144925964647845,
    1.1134802448057444, 1.1124870524407147, 1.1115124652528674,
    1.1105559506519049, 1.1096169964349281, 1.1086951098715616,
    1.1077898167644706
};

const std::vector<double> weights_double {
    0.4220241304586893,    0.2949898387151773,    0.2738882571335921,
    0.2533702702914921,    0.2277683281579276,    0.1536920128324974,
    0.1587034985190487,    0.1396153068217086,    0.1226560006015135,
    0.1403685886319067,    0.1000875457225032,    0.1174621020617644,
    0.1133370860647202,    0.1196537959754125,    0.1052266341782176,
    0.9808123466708629e-1, 0.1112373449506332,    0.1134766286509405,
    0.9873754524814890e-1, 0.1066479426033648,    0.7670924529709856e-1,
    0.7991340941819279e-1, 0.9718247220267912e-1, 0.8540395608805092e-1,
    0.9370090754163923e-1, 0.9451762764710017e-1, 0.6306623675165013e-1,
    0.8752293924939837e-1, 0.8812478650488142e-1, 0.6443866043505561e-1,
    0.8686394599017835e-1, 0.6676663675220322e-1, 0.6225236791974708e-1,
    0.6852853941527126e-1, 0.6362304009692042e-1, 0.7660509151906181e-1,
    0.7224080726405889e-1, 0.6651133438094110e-1, 0.6747381460362881e-1,
    0.5066989935193644e-1, 0.6677694568344836e-1, 0.6032573656659071e-1,
    0.6527624426913266e-1, 0.7301878834268954e-1, 0.6071112059784832e-1,
    0.6946104632400439e-1, 0.4682886483761890e-1, 0.5001592643071046e-1,
    0.5058357405418504e-1, 0.6777400543348672e-1, 0.4574322334260164e-1,
    0.4825000060713178e-1, 0.6122109341504579e-1, 0.5966099905603696e-1,
    0.6438936578256964e-1, 0.5088626525098520e-1, 0.5431668351462945e-1,
    0.5319995862641790e-1, 0.6844795595042751e-1, 0.7083530432175802e-1,
    0.5732051948204511e-1, 0.4490218502103777e-1, 0.6049140426445580e-1,
    0.4930396409349273e-1, 0.5259908244634962e-1, 0.4157689685184839e-1,
    0.4281186243314217e-1, 0.4386995527793346e-1, 0.5125543754353046e-1,
    0.3974944764709748e-1, 0.5264520061529260e-1, 0.5136354041909574e-1,
    0.5442678811184980e-1, 0.5704926826364570e-1, 0.4038441538326142e-1,
    0.3951331812115636e-1, 0.6122812327771460e-1, 0.4801537944066762e-1,
    0.4236317044154080e-1, 0.4152593176194589e-1, 0.6429480105058948e-1,
    0.6509950813587138e-1, 0.3972014228555601e-1, 0.6103909530436719e-1,
    0.5350144961296297e-1, 0.5480829118770150e-1, 0.5295154869098148e-1,
    0.5204411627918511e-1, 0.3992480394903843e-1, 0.4255674649528893e-1,
    0.5774545538915311e-1, 0.5162737400408222e-1, 0.6035410652890054e-1,
    0.4252125662691737e-1, 0.4046055517069407e-1, 0.4226100144993308e-1,
    0.4552846692476320e-1, 0.3751245916126809e-1, 0.5228917258499225e-1,
    0.5172861343990173e-1
};

constexpr std::array y_data_double_direct {
    4.3931925096158482,      2.1965962548079241,      1.4643975032052827,
    1.0982981274039620,      0.87863850192316972,     0.73219875160264136,
    0.62759892994512112,     0.54914906370198102,     0.48813250106842754,
    0.43931925096158486,     0.39938113723780438,     0.36609937580132068,
    0.33793788535506525,     0.31379946497256056,     0.29287950064105656,
    0.27457453185099051,     0.25842308880093223,     0.24406625053421377,
    0.23122065840083411,     0.21965962548079243,     0.20919964331504037,
    0.19969056861890219,     0.19100836998329773,     0.18304968790066034,
    0.17572770038463392,     0.16896894267753262,     0.16271083368947584,
    0.15689973248628028,     0.15148939688330509,     0.14643975032052828,
    0.14171588740696284,     0.13728726592549526,     0.13312704574593479,
    0.12921154440046612,     0.12551978598902422,     0.12203312526710688,
    0.11873493269232023,     0.11561032920041706,     0.11264596178502174,
    0.10982981274039622,     0.10715103681989874,     0.10459982165752019,
    0.10216726766548484,     9.9845284309451096E-002, 9.7626500213685519E-002,
    9.5504184991648866E-002, 9.3472181055656342E-002, 9.1524843950330170E-002,
    8.9656989992160166E-002, 8.7863850192316961E-002, 8.6141029600310753E-002,
    8.4484471338766312E-002, 8.2890424709732985E-002, 8.1355416844737918E-002,
    7.9876227447560871E-002, 7.8449866243140140E-002, 7.7073552800278028E-002,
    7.5744698441652547E-002, 7.4460889993488946E-002, 7.3219875160264139E-002,
    7.2019549337964728E-002, 7.0857943703481419E-002, 6.9733214438346791E-002,
    6.8643632962747628E-002, 6.7587577071013052E-002, 6.6563522872967393E-002,
    6.5570037456952959E-002, 6.4605772200233058E-002, 6.3669456661099244E-002,
    6.2759892994512109E-002, 6.1875950839659834E-002, 6.1016562633553442E-002,
    6.0180719309806133E-002, 5.9367466346160115E-002, 5.8575900128211310E-002,
    5.7805164600208528E-002, 5.7054448176829198E-002, 5.6322980892510872E-002,
    5.5610031767289216E-002, 5.4914906370198108E-002, 5.4236944563158619E-002,
    5.3575518409949369E-002, 5.2930030236335524E-002, 5.2299910828760093E-002,
    5.1684617760186451E-002, 5.1083633832742420E-002, 5.0496465627768369E-002,
    4.9922642154725548E-002, 4.9361713591189307E-002, 4.8813250106842759E-002,
    4.8276840765009321E-002, 4.7752092495824433E-002, 4.7238629135654284E-002,
    4.6736090527828171E-002, 4.6244131680166820E-002, 4.5762421975165085E-002,
    4.5290644429029359E-002, 4.4828494996080083E-002, 4.4375681915311604E-002,
    4.3931925096158481E-002
};
